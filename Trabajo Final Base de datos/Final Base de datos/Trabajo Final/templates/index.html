<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estadísticas de Jugadores</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>⚽ Estadísticas de Jugadores 2025/2026</h1>

        <form method="get" action="/" class="filters-form">
            <div class="filter-group">
                <label for="jugador">Buscar Jugador</label>
                <input type="text" 
                       id="jugador" 
                       name="jugador" 
                       placeholder="Ej: Messi, Ronaldo..." 
                       value="{{ filtro_jugador }}">
            </div>

            <div class="filter-group">
                <label for="equipo">Equipo</label>
                <select id="equipo" name="equipo">
                    <option value="">Todos los equipos</option>
                    {% for e in equipos %}
                    <option value="{{ e }}" {% if e == filtro_equipo %}selected{% endif %}>{{ e }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group">
                <label for="nacionalidad">Nacionalidad</label>
                <select id="nacionalidad" name="nacionalidad">
                    <option value="">Todas las nacionalidades</option>
                    {% for n in nacionalidades %}
                    <option value="{{ n }}" {% if n == filtro_nacionalidad %}selected{% endif %}>{{ n }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group">
                <label for="posicion">Posición</label>
                <select id="posicion" name="posicion">
                    <option value="">Todas las posiciones</option>
                    {% for p in posiciones %}
                    <option value="{{ p }}" {% if p == filtro_posicion %}selected{% endif %}>{{ p }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group">
                <label for="competicion">Competición</label>
                <select id="competicion" name="competicion">
                    <option value="">Todas las competiciones</option>
                    {% for c in competiciones %}
                    <option value="{{ c }}" {% if c == filtro_competicion %}selected{% endif %}>{{ c }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group filter-range">
                <label>Edad</label>
                <div class="range-inputs">
                    <input type="number" 
                           name="edad_min" 
                           placeholder="Mín" 
                           value="{{ edad_min }}" 
                           min="15" 
                           max="45">
                    <span>-</span>
                    <input type="number" 
                           name="edad_max" 
                           placeholder="Máx" 
                           value="{{ edad_max }}" 
                           min="15" 
                           max="45">
                </div>
            </div>

            <div class="filter-group filter-range">
                <label>Goles</label>
                <div class="range-inputs">
                    <input type="number" 
                           name="goles_min" 
                           placeholder="Mín" 
                           value="{{ goles_min }}" 
                           min="0">
                    <span>-</span>
                    <input type="number" 
                           name="goles_max" 
                           placeholder="Máx" 
                           value="{{ goles_max }}" 
                           min="0">
                </div>
            </div>

            <div class="filter-actions">
                <button type="submit" class="btn-search">Buscar</button>
                <a href="/" class="btn-reset">Reiniciar</a>
            </div>
        </form>

        <div class="results-info">
            <p>Mostrando <strong>{{ datos|length }}</strong> resultados</p>
        </div>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>
                            <a href="?jugador={{ filtro_jugador }}&equipo={{ filtro_equipo }}&nacionalidad={{ filtro_nacionalidad }}&posicion={{ filtro_posicion }}&competicion={{ filtro_competicion }}&edad_min={{ edad_min }}&edad_max={{ edad_max }}&goles_min={{ goles_min }}&goles_max={{ goles_max }}&orden_por=id&orden_dir={% if orden_por == 'id' and orden_dir == 'ASC' %}DESC{% else %}ASC{% endif %}" class="sort-link">
                                Rk
                                {% if orden_por == 'id' %}
                                    <span class="sort-arrow">{% if orden_dir == 'ASC' %}▲{% else %}▼{% endif %}</span>
                                {% else %}
                                    <span class="sort-arrow inactive">⇅</span>
                                {% endif %}
                            </a>
                        </th>
                        <th>
                            <a href="?jugador={{ filtro_jugador }}&equipo={{ filtro_equipo }}&nacionalidad={{ filtro_nacionalidad }}&posicion={{ filtro_posicion }}&competicion={{ filtro_competicion }}&edad_min={{ edad_min }}&edad_max={{ edad_max }}&goles_min={{ goles_min }}&goles_max={{ goles_max }}&orden_por=jugador&orden_dir={% if orden_por == 'jugador' and orden_dir == 'ASC' %}DESC{% else %}ASC{% endif %}" class="sort-link">
                                Jugador
                                {% if orden_por == 'jugador' %}
                                    <span class="sort-arrow">{% if orden_dir == 'ASC' %}▲{% else %}▼{% endif %}</span>
                                {% else %}
                                    <span class="sort-arrow inactive">⇅</span>
                                {% endif %}
                            </a>
                        </th>
                        <th>
                            <a href="?jugador={{ filtro_jugador }}&equipo={{ filtro_equipo }}&nacionalidad={{ filtro_nacionalidad }}&posicion={{ filtro_posicion }}&competicion={{ filtro_competicion }}&edad_min={{ edad_min }}&edad_max={{ edad_max }}&goles_min={{ goles_min }}&goles_max={{ goles_max }}&orden_por=nacion&orden_dir={% if orden_por == 'nacion' and orden_dir == 'ASC' %}DESC{% else %}ASC{% endif %}" class="sort-link">
                                Nación
                                {% if orden_por == 'nacion' %}
                                    <span class="sort-arrow">{% if orden_dir == 'ASC' %}▲{% else %}▼{% endif %}</span>
                                {% else %}
                                    <span class="sort-arrow inactive">⇅</span>
                                {% endif %}
                            </a>
                        </th>
                        <th>Posición</th>
                        <th>Equipo</th>
                        <th>Competición</th>
                        <th>
                            <a href="?jugador={{ filtro_jugador }}&equipo={{ filtro_equipo }}&nacionalidad={{ filtro_nacionalidad }}&posicion={{ filtro_posicion }}&competicion={{ filtro_competicion }}&edad_min={{ edad_min }}&edad_max={{ edad_max }}&goles_min={{ goles_min }}&goles_max={{ goles_max }}&orden_por=edad&orden_dir={% if orden_por == 'edad' and orden_dir == 'ASC' %}DESC{% else %}ASC{% endif %}" class="sort-link">
                                Edad
                                {% if orden_por == 'edad' %}
                                    <span class="sort-arrow">{% if orden_dir == 'ASC' %}▲{% else %}▼{% endif %}</span>
                                {% else %}
                                    <span class="sort-arrow inactive">⇅</span>
                                {% endif %}
                            </a>
                        </th>
                        <th>
                            <a href="?jugador={{ filtro_jugador }}&equipo={{ filtro_equipo }}&nacionalidad={{ filtro_nacionalidad }}&posicion={{ filtro_posicion }}&competicion={{ filtro_competicion }}&edad_min={{ edad_min }}&edad_max={{ edad_max }}&goles_min={{ goles_min }}&goles_max={{ goles_max }}&orden_por=goles&orden_dir={% if orden_por == 'goles' and orden_dir == 'ASC' %}DESC{% else %}ASC{% endif %}" class="sort-link">
                                Goles
                                {% if orden_por == 'goles' %}
                                    <span class="sort-arrow">{% if orden_dir == 'ASC' %}▲{% else %}▼{% endif %}</span>
                                {% else %}
                                    <span class="sort-arrow inactive">⇅</span>
                                {% endif %}
                            </a>
                        </th>
                        <th>
                            <a href="?jugador={{ filtro_jugador }}&equipo={{ filtro_equipo }}&nacionalidad={{ filtro_nacionalidad }}&posicion={{ filtro_posicion }}&competicion={{ filtro_competicion }}&edad_min={{ edad_min }}&edad_max={{ edad_max }}&goles_min={{ goles_min }}&goles_max={{ goles_max }}&orden_por=asistencias&orden_dir={% if orden_por == 'asistencias' and orden_dir == 'ASC' %}DESC{% else %}ASC{% endif %}" class="sort-link">
                                Asistencias
                                {% if orden_por == 'asistencias' %}
                                    <span class="sort-arrow">{% if orden_dir == 'ASC' %}▲{% else %}▼{% endif %}</span>
                                {% else %}
                                    <span class="sort-arrow inactive">⇅</span>
                                {% endif %}
                            </a>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% if datos %}
                        {% for fila in datos %}
                        <tr>
                            <td>{{ fila.Rk }}</td>
                            <td class="player-name">{{ fila.Player }}</td>
                            <td>{{ fila.Nation }}</td>
                            <td>{{ fila.Pos if fila.Pos else '-' }}</td>
                            <td>{{ fila.Squad if fila.Squad else '-' }}</td>
                            <td>{{ fila.Comp if fila.Comp else '-' }}</td>
                            <td>{{ fila.Age }}</td>
                            <td class="stat-number">{{ fila.Gls }}</td>
                            <td class="stat-number">{{ fila.Ast }}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="9" class="no-results">
                                <div class="no-results-content">
                                    <span class="icon">🔍</span>
                                    <p>No se encontraron jugadores con los filtros aplicados</p>
                                    <a href="/" class="btn-reset-inline">Limpiar filtros</a>
                                </div>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>